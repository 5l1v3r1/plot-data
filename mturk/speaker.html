<html>
 <head>
 <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
 <script type='text/javascript' src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js'></script>
 <link href="https://s3.amazonaws.com/mturk-public/bs30/css/bootstrap.min.css" rel="stylesheet" />
 </head>
 <body>
     <div class="panel panel-primary">
     <div class="panel-heading"><strong style="font-size: 1.5em;">Instructions</strong></div>
     <div class="panel-body">
     <p>The link will take you to a page containing some plots, you are to provide 5 labels by clicking on the <b>label</b> button on top of each plot.</p>
     <p>There is another worker, and you want them to make &quot;New plot&quot; based on &quot;Old plot&quot;, what would you say? That is what you should write in the box.</p>
     <p>Your command will be tested on another worker, and a bonus will be awarded if they succeed in picking out the target based on your command.&nbsp;</p>
     <p>Finally, copy and paste the code once it appears back here and then submit.</p>

     <p>&nbsp;</p>

     <p>When the difference is hard to see, open the "compare and label" window. There is a switch to toggle between the old plot and the new plot for a visual contrast.</p>

     <p>Pay attention to spacing, paddings, fonts, etc&nbsp;which are important differences.</p>

     <p>If you really do not find any difference, click on the no change button. You are free to only describe those plots that have noticeable&nbsp;change and skip the rest.</p>

     <p>If you run out of plots to label before completing the task, click on &quot;<strong>Load more</strong>&quot; for a new set. You should also click on &quot;<strong>Load more&quot;&nbsp;</strong>if you feel you cannot provide a clear command for what is currently there.</p>

     <p><strong>Tips:</strong></p>
     <ul>
     	<li>To maximize your accuracy, use simple and precise language in a command form: &quot;make the x label bigger&quot;, NOT &quot;new plot is different&quot;</li>
     	<li>Do NOT talk about new/old explicitly: &quot;The new plot is bigger than the old one&quot;</li>
     	<li>Do NOT refresh your browser, for you will lose your points. Use the &quot;load more&quot; button.</li>
     </ul>

     <p><strong>Notes</strong></p>
     <ul>
     	<li>You will be rejected and permanantly if you spam us</li>
     	<li>We are granting qualifications to a list of good workers for these tasks</li>
        <li>Bonus is awarded if other workers can perform your command with high accuracy</li>
     </ul>
     </div>
     </div>
     <!-- End Instruction -->

     <div style="display: none;">${hitid}</div>

     <div id="myelementLink" style="font-size: 0.9em; display: inline;"><tt>URL not shown because there is an error with Javascript on your computer. To perform this HIT, you must have Javascript and cookies enabled on your browser.</tt></div>

     <div style="font-size: 0.9em;"><strong>&nbsp;Please copy your completion code from the task window,&nbsp; paste below and submit</strong></div>



 <form name='mturk_form' method='post' id='mturk_form' action='https://www.mturk.com/mturk/externalSubmit'>
 <input type='hidden' value='' name='assignmentId' id='assignmentId'/>
 <div><textarea class="form-control" cols="80" id="code" name="code" rows="1" type="text"></textarea></div>
 <p><input type='submit' id='submitButton' value='Submit'/></p></form>

<script type="text/javascript" language="JavaScript">
 turkSetAssignmentID();
 var assignment_id_field = document.getElementById('myelementLink');
 var sessionId = turkGetParam('workerId', "") + '_' + turkGetParam('assignmentId', "")
 if (turkGetParam('assignmentId', "") == "" || turkGetParam('assignmentId', "") == "ASSIGNMENT_ID_NOT_AVAILABLE" )
     assignment_id_field.innerHTML = 'No assignmentId, you must first accept the task.';
 else
     assignment_id_field.innerHTML = '<a target="_blank" href="http://plot.sidaw.xyz/#/label/build?uid=' + sessionId +
 '"><h1><span style="color: rgb(255, 0, 0);font-size:25"><span><b>Clikc here to start task.</b></span></span></h1></a>';

 function validateCode() {
     document.getElementById('code').value = document.getElementById('code').value.trim();
     var code = document.getElementById('code').value;
     try {
         codeobj = JSON.parse(atob(code));
     } catch (parseError) {
         window.alert('incorrect code, make sure you copy the entire thing and remove spaces')
         return false;
     }
     console.log(code, codeobj);
     if (codeobj.sessionId && codeobj.sessionId===sessionId) {
         console.log('the code is good')
         return true;
     } else {
         window.alert('incorrect code, make sure you copy the entire thing and remove spaces')
         return false;
     }
 }
 window.onload = function() {document.getElementById('submitButton').setAttribute('onclick', 'return validateCode()'); }
</script>
 </body>
</html>
